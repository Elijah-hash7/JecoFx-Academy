---
import { Image } from "astro:assets";
import derivLogo from "../../assets/deriv-logo.png";
import tradingViewLogo from "../../assets/tradingview-logo.png";

const partners = [
  { name: "TradingView", logo: tradingViewLogo, width: 182, height: 48 },
  { name: "Deriv", logo: derivLogo, width: 160, height: 48 },
];

const repeatedPartners = Array.from({ length: 10 }, (_, idx) => partners[idx % partners.length]);
const marqueePartners = [...repeatedPartners, ...repeatedPartners];
---

<style>
  @keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }

  .animate-marquee {
    animation: marquee 50s linear infinite;
  }

  @media (prefers-reduced-motion: reduce) {
    .animate-marquee {
      animation: none;
    }
  }
</style>

<section id="partners" class="py-10 bg-[var(--bg-alt)] border-y border-[var(--border)]">
  <div class="max-w-7xl mx-auto px-6 lg:px-8 flex flex-col items-center">
    <h3 class="text-base font-semibold text-[var(--text)] mb-10 text-center">
      Trusted by leading businesses worldwide.
    </h3>
    <div class="w-full overflow-hidden">
      <div class="flex w-max items-center gap-11 md:gap-30 whitespace-nowrap animate-marquee">
        {marqueePartners.map((partner, idx) => (
          <a
            href="#"
            class="flex-shrink-0"
            target="_blank"
            rel="noopener noreferrer"
            aria-hidden={idx >= repeatedPartners.length}
            tabindex={idx >= repeatedPartners.length ? -1 : undefined}
          >
            <Image
              src={partner.logo}
              alt={partner.name}
              width={partner.width}
              height={partner.height}
              loading="lazy"
              decoding="async"
              class="h-10 md:h-12 w-auto max-w-none object-contain transition-all duration-200 opacity-100"
            />
          </a>
        ))}
      </div>
    </div>
  </div>
</section>
